# DD Pipeline 中斷流程

中斷目前正在執行的 DD Pipeline 流程。

---

## 執行步驟

1. **讀取當前狀態**：
   - 讀取 `PROJECT_STATE.md`
   - 確認當前階段

2. **確認中斷**：
   ```
   ═══════════════════════════════════════════════════════════════════
   ⚠️ 確定要中斷 DD Pipeline 流程嗎？
   ═══════════════════════════════════════════════════════════════════

   當前狀態：
   ├── 階段：後端測試
   ├── 迭代：第 2 次
   └── 進度：60%

   中斷後：
   ├── 進度會保存到 PROJECT_STATE.md
   ├── 未完成的變更會 commit 為 WIP
   ├── 可以使用 /dd-status 查看狀態
   └── 可以使用 /dd-approve 繼續流程

   確定要中斷嗎？[y/N]
   ```

3. **保存狀態**：

   更新 `PROJECT_STATE.md`：
   ```markdown
   ## 當前階段
   ⏸️ 已中斷 - 後端測試（第 2 次迭代）

   ## 中斷資訊
   - 時間：2024-01-15 12:00
   - 原因：用戶手動中斷
   - 可從此處繼續
   ```

4. **Git commit**（如果有未提交的變更）：
   ```bash
   git add .
   git commit -m "wip: DD Pipeline 中斷 - 後端測試第2次迭代"
   ```

5. **顯示恢復指引**：
   ```
   ═══════════════════════════════════════════════════════════════════
   ⏸️ DD Pipeline 已中斷
   ═══════════════════════════════════════════════════════════════════

   已保存狀態：
   ├── 階段：後端測試（第 2 次迭代）
   ├── 進度：60%
   └── Git：wip commit 已建立

   恢復方式：
   ├── /dd-approve  從中斷處繼續
   ├── /dd-status   查看詳細狀態
   └── /dd-arch     重新開始架構設計（會覆蓋進度）

   注意事項：
   └── 下次執行 /dd-approve 會從中斷處繼續，不會重新開始

   ═══════════════════════════════════════════════════════════════════
   ```

---

## 不同階段的中斷處理

### 架構設計中
- 直接中斷
- 下次執行 `/dd-arch` 會重新開始

### 開發中
- 保存當前程式碼
- 下次執行 `/dd-approve` 會繼續開發

### 測試中
- 保存測試狀態
- 記錄當前迭代次數
- 下次執行 `/dd-approve` 會繼續測試

### 修正中
- 保存修正進度
- 下次執行 `/dd-approve` 會繼續修正流程

---

## 恢復流程

當用戶執行 `/dd-approve` 恢復時：

1. **讀取中斷狀態**：
   - 從 `PROJECT_STATE.md` 讀取中斷資訊

2. **顯示恢復確認**：
   ```
   📋 偵測到中斷的流程

   中斷資訊：
   ├── 階段：後端測試（第 2 次迭代）
   ├── 時間：2024-01-15 12:00
   └── 進度：60%

   選項：
   1. 從中斷處繼續
   2. 重新開始（會覆蓋進度）

   請選擇 [1/2]：
   ```

3. **繼續執行**：
   - 從中斷的階段和迭代繼續

---

## 無需調用 Agent/Skill

此命令只處理流程控制，不執行任何開發操作。

使用的工具：
- **Read**：讀取狀態檔
- **Write**：更新狀態檔
- **Bash**：執行 git commit
- **AskUserQuestion**：確認中斷
