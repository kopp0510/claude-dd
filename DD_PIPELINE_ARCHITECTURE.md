# DD Pipeline 開發架構圖

> 多 Agent 協作的驅動開發流程系統

## 完整流程架構

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              DD Pipeline 完整流程                                    │
└─────────────────────────────────────────────────────────────────────────────────────┘

                                    ┌─────────────┐
                                    │   用戶輸入   │
                                    │  專案需求    │
                                    └──────┬──────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  /dd-init                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────────────┐    │
│  │  初始化專案                                                                   │    │
│  │  • 建立 claude_docs/ 目錄                                                     │    │
│  │  • 建立 CLAUDE.md（專案設定）                                                  │    │
│  │  • 建立 PROJECT_STATE.md（狀態追蹤）                                           │    │
│  └─────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  /dd-start (RDD 需求驅動)                                                            │
│  ┌─────────────────────────────────────────────────────────────────────────────┐    │
│  │  📋 需求分析階段                                                              │    │
│  │  ├── Agent: systems-architect                                               │    │
│  │  ├── Skill: senior-architect, ux-researcher-designer                        │    │
│  │  └── 產出: REQUIREMENTS.md                                                   │    │
│  └─────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  /dd-arch (SDD + DDD + ADD + EDD)                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────────┐    │
│  │  🏗️ 架構設計階段                                                              │    │
│  │                                                                             │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │     SDD      │  │     DDD      │  │     ADD      │  │     EDD      │     │    │
│  │  │  系統結構設計  │  │  領域模型設計  │  │  架構決策記錄  │  │  範例驅動設計  │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  │                                                                             │    │
│  │  ├── Agent: systems-architect                                               │    │
│  │  ├── Skill: senior-architect, senior-backend, senior-frontend               │    │
│  │  └── 產出: ARCHITECTURE.md, ADR-XXX.md, EXAMPLES.md                          │    │
│  └─────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
                              ┌────────────────────────┐
                              │   🔒 人工審核 Checkpoint │
                              │   /dd-approve 確認架構  │
                              │   /dd-revise 修改架構   │
                              └───────────┬────────────┘
                                          │
                        ┌─────────────────┴─────────────────┐
                        │                                   │
                        ▼                                   ▼
              ┌─────────────────┐                 ┌─────────────────┐
              │   ✅ 批准開發    │                 │   🔄 返回修改    │
              └────────┬────────┘                 └────────┬────────┘
                       │                                   │
                       │                                   └──────────────────┐
                       ▼                                                      │
┌─────────────────────────────────────────────────────────────────────────────┼───────┐
│  /dd-dev (DbC + CDD + PDD) - 自動執行                                        │       │
│  ┌─────────────────────────────────────────────────────────────────────────┐│       │
│  │  💻 開發實作階段                                                          ││       │
│  │                                                                         ││       │
│  │  ┌────────────────────────────────────────────────────────────────┐     ││       │
│  │  │                        並行開發                                  │    ││       │
│  │  │  ┌──────────────────┐          ┌──────────────────┐            │     ││       │
│  │  │  │     後端開發      │          │     前端開發      │             │     ││       │
│  │  │  │                  │          │                  │            │     ││       │
│  │  │  │ Agent:           │          │ Agent:           │            │     ││       │
│  │  │  │ • test-engineer  │          │ • test-engineer  │            │     ││       │
│  │  │  │ • security-auditor│         │ • security-auditor│           │     ││       │
│  │  │  │                  │          │                  │            │     ││       │
│  │  │  │ Skill:           │          │ Skill:           │            │     ││       │
│  │  │  │ • senior-backend │          │ • senior-frontend│            │     ││       │
│  │  │  │ • senior-fullstack│         │ • senior-fullstack│           │     ││       │
│  │  │  │ • code-reviewer  │          │ • code-reviewer  │            │     ││       │
│  │  │  │                  │          │ • ui-design-system│           │     ││       │
│  │  │  └──────────────────┘          └──────────────────┘            │     ││       │
│  │  └────────────────────────────────────────────────────────────────┘     ││       │
│  │                                                                         ││       │
│  │  ├── DbC: 契約驅動 → API_CONTRACT.md                                     ││       │
│  │  ├── CDD: 元件驅動 → 可重用元件                                            ││       │
│  │  └── PDD: 提示驅動 → 最佳化 AI 協作                                        ││       │
│  └─────────────────────────────────────────────────────────────────────────┘│       │
└─────────────────────────────────────────────────────────────────────────────┼───────┘
                       │                                                      │
                       │ 自動觸發                                              │
                       ▼                                                      │
┌─────────────────────────────────────────────────────────────────────────────┼───────┐
│  /dd-test (TDD + BDD + ATDD + FDD) - 自動執行                                │       │
│  ┌─────────────────────────────────────────────────────────────────────────┐│       │
│  │  🧪 測試審查階段                                                          ││       │
│  │                                                                         ││       │
│  │  ┌────────────────────────────────────────────────────────────────┐     ││       │
│  │  │                        並行測試                                  │    ││       │
│  │  │  ┌──────────────────┐          ┌──────────────────┐            │     ││       │
│  │  │  │     後端測試      │          │     前端測試       │            │     ││       │
│  │  │  │                  │          │                  │            │     ││       │
│  │  │  │ • 單元測試        │          │ • E2E 測試        │            │     ││       │
│  │  │  │ • 整合測試        │          │ • UI/UX 審查      │            │     ││       │
│  │  │  │ • API 契約驗證    │          │ • 視覺回歸測試     │            │     ││       │
│  │  │  │                  │          │                  │            │     ││       │
│  │  │  │ Agent:           │          │ MCP:             │            │     ││       │
│  │  │  │ • test-engineer  │          │ • Playwright     │            │     ││       │
│  │  │  │ • security-auditor│         │                  │            │     ││       │
│  │  │  │                  │          │ Agent:           │            │     ││       │
│  │  │  │ Skill:           │          │ • test-engineer  │            │     ││       │
│  │  │  │ • senior-qa      │          │                  │            │     ││       │
│  │  │  │ • senior-secops  │          │ Skill:           │            │     ││       │
│  │  │  │                  │          │ • senior-qa      │            │     ││       │
│  │  │  │                  │          │ • ui-design-system│           │     ││       │
│  │  │  │                  │          │ • ux-researcher  │            │     ││       │
│  │  │  └──────────────────┘          └──────────────────┘            │     ││       │
│  │  └────────────────────────────────────────────────────────────────┘     ││       │
│  │                                                                         ││       │
│  │  ├── TDD: 測試驅動開發                                                    ││       │
│  │  ├── BDD: 行為驅動開發                                                    ││       │
│  │  ├── ATDD: 驗收測試驅動                                                   ││       │
│  │  └── FDD: 功能驅動開發                                                    ││       │
│  └─────────────────────────────────────────────────────────────────────────┘│       │
└─────────────────────────────────────────────────────────────────────────────┼───────┘
                       │                                                      │
                       ▼                                                      │
              ┌─────────────────┐                                             │
              │   測試結果判定    │                                             │
              └────────┬────────┘                                             │
                       │                                                      │
         ┌─────────────┴─────────────┐                                        │
         │                           │                                        │
         ▼                           ▼                                        │
┌─────────────────┐        ┌─────────────────┐                                │
│   ✅ 測試通過    │        │   ❌ 測試失敗     │                                │
└────────┬────────┘        └────────┬────────┘                                │
         │                          │                                         │
         │                          ▼                                         │
         │                 ┌─────────────────┐                                │
         │                 │   重試計數 < 3   │                                │
         │                 └────────┬────────┘                                │
         │                          │                                         │
         │            ┌─────────────┴─────────────┐                           │
         │            │                           │                           │
         │            ▼                           ▼                           │
         │   ┌─────────────────┐        ┌─────────────────┐                   │
         │   │   🔄 自動修正    │        │   ⚠️ 需人工介入   │                   │
         │   │  (回到開發階段)   │        │   (超過重試次數)  │                   │
         │   └────────┬────────┘        └─────────────────┘                   │
         │            │                                                       │
         │            └───────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  完成階段                                                                            │
│  ┌─────────────────────────────────────────────────────────────────────────────┐    │
│  │  📄 文檔生成                                                                 │    │
│  │  ├── Agent: docs-writer                                                     │    │
│  │  └── 產出: API 文檔、使用指南、變更日誌                                          │    │
│  └─────────────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐    │
│  │  🔧 效能優化                                                                 │    │
│  │  ├── Agent: performance-tuner, refactor-expert                              │    │
│  │  └── 執行: 效能分析、程式碼重構                                                 │    │
│  └─────────────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐    │
│  │  🔒 安全審查                                                                 │    │
│  │  ├── Agent: security-auditor                                                │    │
│  │  ├── Skill: senior-security, senior-secops                                  │    │
│  │  └── 執行: 最終安全掃描                                                        │    │
│  └─────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
                              ┌────────────────────────┐
                              │    🎉 準備發布/部署      │
                              └────────────────────────┘
```

---

## DD 模式對照表

| DD 模式 | 全名 | 階段 | 主要職責 |
|---------|------|------|----------|
| RDD | Requirements-Driven Development | 需求分析 | 收集和分析需求 |
| SDD | Structure-Driven Development | 架構設計 | 系統結構設計 |
| DDD | Domain-Driven Design | 架構設計 | 領域模型設計 |
| ADD | Architecture Decision Records | 架構設計 | 記錄架構決策 |
| EDD | Example-Driven Development | 架構設計 | 範例驅動設計 |
| DbC | Design by Contract | 開發實作 | API 契約定義 |
| CDD | Component-Driven Development | 開發實作 | 元件化開發 |
| PDD | Prompt-Driven Development | 開發實作 | AI 協作優化 |
| TDD | Test-Driven Development | 測試審查 | 單元測試 |
| BDD | Behavior-Driven Development | 測試審查 | 行為測試 |
| ATDD | Acceptance Test-Driven Development | 測試審查 | 驗收測試 |
| FDD | Feature-Driven Development | 測試審查 | 功能驗證 |

---

## Agent/Skill/MCP 配置

### Agents（8 個）
| Agent | 主要階段 | 職責 |
|-------|----------|------|
| systems-architect | 需求/架構 | 系統架構設計 |
| test-engineer | 開發/測試 | 測試工程 |
| security-auditor | 開發/測試/完成 | 安全審計 |
| docs-writer | 完成 | 文檔撰寫 |
| refactor-expert | 完成 | 程式碼重構 |
| performance-tuner | 完成 | 效能調校 |
| root-cause-analyzer | 測試 | 問題分析 |
| config-safety-reviewer | 開發 | 配置審查 |

### Skills（12 個）
| Skill | 主要階段 | 職責 |
|-------|----------|------|
| senior-architect | 需求/架構 | 架構設計專家 |
| senior-backend | 架構/開發 | 後端開發專家 |
| senior-frontend | 架構/開發 | 前端開發專家 |
| senior-fullstack | 開發 | 全端開發專家 |
| senior-qa | 測試 | 品質保證專家 |
| senior-devops | 完成 | DevOps 專家 |
| senior-secops | 測試/完成 | 安全運維專家 |
| senior-security | 完成 | 安全專家 |
| senior-prompt-engineer | 開發 | 提示工程專家 |
| code-reviewer | 開發 | 程式碼審查 |
| ui-design-system | 測試 | UI 設計系統 |
| ux-researcher-designer | 需求/測試 | UX 研究設計 |

### MCP（必要）
| MCP | 用途 |
|-----|------|
| Playwright | 前端 E2E 測試 |

### MCP（建議）
| MCP | 用途 |
|-----|------|
| sequential-thinking | 複雜推理 |
| claude-mem | 跨 session 記憶 |
| serena | 程式碼分析 |
| cipher | 加密處理 |
| zeabur | 部署整合 |
| google-docs | 文檔協作 |
| googleDrive | 檔案儲存 |

---

## 命令列表

| 命令 | 說明 | 觸發方式 |
|------|------|----------|
| `/dd-help` | 查看使用說明 | 手動 |
| `/dd-init` | 初始化專案 | 手動 |
| `/dd-start` | 啟動需求分析 | 手動 |
| `/dd-arch` | 進入架構設計 | 手動 |
| `/dd-approve` | 批准架構開始開發 | 手動（Checkpoint） |
| `/dd-revise` | 修改架構 | 手動 |
| `/dd-dev` | 開發實作 | 自動（批准後） |
| `/dd-test` | 測試審查 | 自動（開發後） |
| `/dd-status` | 查看進度 | 手動 |
| `/dd-stop` | 中斷流程 | 手動 |

---

## 檔案結構

```
專案根目錄/
├── CLAUDE.md                    # 專案設定（DD Pipeline 配置）
└── claude_docs/                 # DD 產生的文檔
    ├── PROJECT_STATE.md         # 狀態追蹤
    ├── REQUIREMENTS.md          # 需求文檔（RDD）
    ├── ARCHITECTURE.md          # 架構文檔（SDD/DDD）
    ├── API_CONTRACT.md          # API 契約（DbC）
    ├── EXAMPLES.md              # 範例文檔（EDD）
    └── adr/                     # 架構決策記錄（ADD）
        ├── ADR-001.md
        └── ADR-002.md
```

---

## 來源

- **Agents**: https://github.com/alirezarezvani/claude-code-tresor
- **Skills**: https://github.com/alirezarezvani/claude-skills

---

**建立日期**：2025-12-15
**版本**：1.0.0
